

## Проблема

Файлы не открываются у пользователя по двум возможным причинам:

1. **Блокировка всплывающих окон браузером** -- `window.open()` вызывается после `await` (асинхронно), а не напрямую из обработчика клика. Браузеры блокируют такие окна как попапы.

2. **RLS-политика хранилища** -- хотя текущая политика должна работать, нужно убедиться, что она корректно пропускает запросы обычных пользователей.

## Решение

Переписать логику открытия файлов во всех компонентах, чтобы:
- Сначала открывать пустое окно синхронно (до `await`)
- Затем менять URL этого окна на подписанную ссылку
- Показывать ошибку, если получить ссылку не удалось

### Затронутые файлы

1. **`src/tabs/ProtocolsTab.tsx`** -- функция `handleOpenFile`
2. **`src/tabs/DashboardTab.tsx`** -- открытие файлов сессий (строки 230-232)
3. **`src/tabs/RoadmapsTab.tsx`** -- открытие файлов дорожных карт (строки 113-116)

### Технические детали

Паттерн замены во всех трех файлах:

```typescript
// БЫЛО (блокируется браузером):
const { data } = await supabase.storage.from('mentoring-files').createSignedUrl(path, 3600);
if (data?.signedUrl) window.open(data.signedUrl, '_blank');

// СТАЛО (работает корректно):
const newWindow = window.open('', '_blank'); // открываем синхронно
const { data, error } = await supabase.storage.from('mentoring-files').createSignedUrl(path, 3600);
if (data?.signedUrl && newWindow) {
  newWindow.location.href = data.signedUrl;
} else {
  newWindow?.close();
  // показать ошибку
}
```

Также добавлю дополнительную RLS-политику для надежности -- разрешение на `SELECT` для аутентифицированных пользователей, чьи файлы лежат в папке с их user ID.

